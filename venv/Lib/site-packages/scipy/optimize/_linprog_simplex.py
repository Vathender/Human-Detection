"""Simplex method for  linear programming

The *simplex* method uses a traditional, full-tableau implementation of
Dantzig's simplex algorithm [1]_, [2]_ (*not* the Nelder-Mead simplex).
This algorithm is included for backwards compatibility and educational
purposes.

    .. versionadded:: 0.15.0

Warnings
--------

The simplex method may encounter numerical difficulties when pivot
values are close to the specified tolerance. If encountered try
remove any redundant constraints, change the pivot strategy to Bland's
rule or increase the tolerance value.

Alternatively, more robust methods maybe be used. See
:ref:`'interior-point' <optimize.linprog-interior-point>` and
:ref:`'revised simplex' <optimize.linprog-revised_simplex>`.

References
----------
.. [1] Dantzig, George B., Linear programming and extensions. Rand
       Corporation Research Study Princeton Univ. Press, Princeton, NJ,
       1963
.. [2] Hillier, S.H. and Lieberman, G.J. (1995), "Introduction to
       Mathematical Programming", McGraw-Hill, Chapter 4.
"""

import numpy as np
from warnings import warn
from .optimize import OptimizeResult, OptimizeWarning, _check_unknown_options
from ._linprog_util import _postsolve


def _pivot_col(T, tol=1e-9, bland=False):
    """
    Given a linear programming simplex tableau, determine the column
    of the variable to enter the basis.

    Parameters
    ----------
    T : 2-D array
        A 2-D array representing the simplex tableau, T, corresponding to the
        linear programming problem. It should have the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],    0]]

        for a Phase 2 problem, or the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],   0],
         [c'[0],  c'[1], ...,  c'[n_total],  0]]

         for a Phase 1 problem (a problem in which a basic feasible solution is
         sought prior to maximizing the actual objective. ``T`` is modified in
         place by ``_solve_simplex``.
    tol : float
        Elements in the objective row larger than -tol will not be considered
        for pivoting. Nominally this value is zero, but numerical issues
        cause a tolerance about zero to be necessary.
    bland : bool
        If True, use Bland's rule for selection of the column (select the
        first column with a negative coefficient in the objective row,
        regardless of magnitude).

    Returns
    -------
    status: bool
        True if a suitable pivot column was found, otherwise False.
        A return of False indicates that the linear programming simplex
        algorithm is complete.
    col: int
        The index of the column of the pivot element.
        If status is False, col will be returned as nan.
    """
    ma = np.ma.masked_where(T[-1, :-1] >= -tol, T[-1, :-1], copy=False)
    if ma.count() == 0:
        return False, np.nan
    if bland:
        # ma.mask is sometimes 0d
        return True, np.nonzero(np.logical_not(np.atleast_1d(ma.mask)))[0][0]
    return True, np.ma.nonzero(ma == ma.min())[0][0]


def _pivot_row(T, basis, pivcol, phase, tol=1e-9, bland=False):
    """
    Given a linear programming simplex tableau, determine the row for the
    pivot operation.

    Parameters
    ----------
    T : 2-D array
        A 2-D array representing the simplex tableau, T, corresponding to the
        linear programming problem. It should have the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],    0]]

        for a Phase 2 problem, or the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],   0],
         [c'[0],  c'[1], ...,  c'[n_total],  0]]

         for a Phase 1 problem (a Problem in which a basic feasible solution is
         sought prior to maximizing the actual objective. ``T`` is modified in
         place by ``_solve_simplex``.
    basis : array
        A list of the current basic variables.
    pivcol : int
        The index of the pivot column.
    phase : int
        The phase of the simplex algorithm (1 or 2).
    tol : float
        Elements in the pivot column smaller than tol will not be considered
        for pivoting. Nominally this value is zero, but numerical issues
        cause a tolerance about zero to be necessary.
    bland : bool
        If True, use Bland's rule for selection of the row (if more than one
        row can be used, choose the one with the lowest variable index).

    Returns
    -------
    status: bool
        True if a suitable pivot row was found, otherwise False. A return
        of False indicates that the linear programming problem is unbounded.
    row: int
        The index of the row of the pivot element. If status is False, row
        will be returned as nan.
    """
    if phase == 1:
        k = 2
    else:
        k = 1
    ma = np.ma.masked_where(T[:-k, pivcol] <= tol, T[:-k, pivcol], copy=False)
    if ma.count() == 0:
        return False, np.nan
    mb = np.ma.masked_where(T[:-k, pivcol] <= tol, T[:-k, -1], copy=False)
    q = mb / ma
    min_rows = np.ma.nonzero(q == q.min())[0]
    if bland:
        return True, min_rows[np.argmin(np.take(basis, min_rows))]
    return True, min_rows[0]


def _apply_pivot(T, basis, pivrow, pivcol, tol=1e-9):
    """
    Pivot the simplex tableau inplace on the element given by (pivrow, pivol).
    The entering variable corresponds to the column given by pivcol forcing
    the variable basis[pivrow] to leave the basis.

    Parameters
    ----------
    T : 2-D array
        A 2-D array representing the simplex tableau, T, corresponding to the
        linear programming problem. It should have the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],    0]]

        for a Phase 2 problem, or the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],   0],
         [c'[0],  c'[1], ...,  c'[n_total],  0]]

         for a Phase 1 problem (a problem in which a basic feasible solution is
         sought prior to maximizing the actual objective. ``T`` is modified in
         place by ``_solve_simplex``.
    basis : 1-D array
        An array of the indices of the basic variables, such that basis[i]
        contains the column corresponding to the basic variable for row i.
        Basis is modified in place by _apply_pivot.
    pivrow : int
        Row index of the pivot.
    pivcol : int
        Column index of the pivot.
    """
    basis[pivrow] = pivcol
    pivval = T[pivrow, pivcol]
    T[pivrow] = T[pivrow] / pivval
    for irow in range(T.shape[0]):
        if irow != pivrow:
            T[irow] = T[irow] - T[pivrow] * T[irow, pivcol]

    # The selected pivot should never lead to a pivot value less than the tol.
    if np.isclose(pivval, tol, atol=0, rtol=1e4):
        message = (
            "The pivot operation produces a pivot value of:{0: .1e}, "
            "which is only slightly greater than the specified "
            "tolerance{1: .1e}. This may lead to issues regarding the "
            "numerical stability of the simplex method. "
            "Removing redundant constraints, changing the pivot strategy "
            "via Bland's rule or increasing the tolerance may "
            "help reduce the issue.".format(pivval, tol))
        warn(message, OptimizeWarning, stacklevel=5)


def _solve_simplex(T, n, basis, callback, postsolve_args,
                   maxiter=1000, tol=1e-9, phase=2, bland=False, nit0=0,
                   ):
    """
    Solve a linear programming problem in "standard form" using the Simplex
    Method. Linear Programming is intended to solve the following problem form:

    Minimize::

        c @ x

    Subject to::

        A @ x == b
            x >= 0

    Parameters
    ----------
    T : 2-D array
        A 2-D array representing the simplex tableau, T, corresponding to the
        linear programming problem. It should have the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],    0]]

        for a Phase 2 problem, or the form:

        [[A[0, 0], A[0, 1], ..., A[0, n_total], b[0]],
         [A[1, 0], A[1, 1], ..., A[1, n_total], b[1]],
         .
         .
         .
         [A[m, 0], A[m, 1], ..., A[m, n_total], b[m]],
         [c[0],   c[1], ...,   c[n_total],   0],
         [c'[0],  c'[1], ...,  c'[n_total],  0]]

         for a Phase 1 problem (a problem in which a basic feasible solution is
         sought prior to maximizing the actual objective. ``T`` is modified in
         place by ``_solve_simplex``.
    n : int
        The number of true variables in the problem.
    basis : 1-D array
        An array of the indices of the basic variables, such that basis[i]
        contains the column corresponding to the basic variable for row i.
        Basis is modified in place by _solve_simplex
    callback : callable, optional
        If a callback function is provided, it will be called within each
        iteration of the algorithm. The callback must accept a
        `scipy.optimize.OptimizeResult` consisting of the following fields:

            x : 1-D array
                Current solution vector
            fun : float
                Current value of the objective function
            success : bool
                True only when a phase has completed successfully. This
                will be False for most iterations.
            slack : 1-D array
                The values of the slack variables. Each slack variable
                corresponds to an inequality constraint. If the slack is zero,
                the corresponding constraint is active.
            con : 1-D array
                The (nominally zero) residuals of the equality constraints,
                that is, ``b - A_eq @ x``
            phase : int
                The phase of the optimization being executed. In phase 1 a basic
                feasible solution is sought and the T has an additional row
                representing an alternate objective function.
            status : int
                An integer representing the exit status of the optimization::

                     0 : Optimization terminated successfully
                     1 : Iteration limit reached
                     2 : Problem appears to be infeasible
                     3 : Problem appears to be unbounded
                     4 : Serious numerical difficulties encountered

            nit : int
                The number of iterations performed.
            message : str
                A string descriptor of the exit status of the optimization.
    postsolve_args : tuple
        Data needed by _postsolve to convert the solution to the standard-form
        problem into the solution to the original problem.
    maxiter : int
        The maximum number of iterations to perform before aborting the
        optimization.
    tol : float
        The tolerance which determines when a solution is "close enough" to
        zero in Phase 1 to be considered a basic feasible solution or close
        enough to positive to serve as an optimal solution.
    phase : int
        The phase of the optimization being executed. In phase 1 a basic
        feasible solution is sought and the T has an additional row
        representing an alternate objective function.
    bland : bool
        If True, choose pivots using Bland's rule [3]_. In problems which
        fail to converge due to cycling, using Bland's rule can provide
        convergence at the expense of a less optimal path about the simplex.
    nit0 : int
        The initial iteration number used to keep an accurate iteration total
        in a two-phase problem.

    Returns
    -------
    nit : int
        The number of iterations. Used to keep an accurate iteration total
        in the two-phase problem.
    status : int
        An integer representing the exit status of the optimization::

         0 : Optimization terminated successfully
         1 : Iteration limit reached
         2 : Problem appears to be infeasible
         3 : Problem appears to be unbounded
         4 : Serious numerical difficulties encountered

    """
    nit = nit0
    status = 0
    message = ''
    complete = False

    if phase == 1:
        m = T.shape[1]-2
    elif phase == 2:
        m = T.shape[1]-1
    else:
        raise ValueError("Argument 'phase' to _solve_simplex must be 1 or 2")

    if phase == 2:
        # Check if any artificial variables are still in the basis.
        # If yes, check if any coefficients from this row and a column
        # corresponding to one of the non-artificial variable is non-zero.
        # If found, pivot at this term. If not, start phase 2.
        # Do this for all artificial variables in the basis.
        # Ref: "An Introduction to Linear Programming and Game Theory"
        # by Paul R. Thie, Gerard E. Keough, 3rd Ed,
        # Chapter 3.7 Redundant Systems (pag 102)
        for pivrow in [row for row in range(basis.size)
                       if basis[row] > T.shape[1] - 2]:
            non_zero_row = [col for col in range(T.shape[1] - 1)
                            if abs(T[pivrow, col]) > tol]
            if len(non_zero_row) > 0:
                pivcol = non_zero_row[0]
                _apply_pivot(T, basis, pivrow, pivcol, tol)
                nit += 1

    if len(basis[:m]) == 0:
        solution = np.empty(T.shape[1] - 1, dtype=np.float64)
    else:
        solution = np.empty(max(T.shape[1] - 1, max(basis[:m]) + 1),
                            dtype=np.float64)

    while not complete:
        # Find the pivot column
        pivcol_found, pivcol = _pivot_col(T, tol, bland)
        if not pivcol_found:
            pivcol = np.nan
            pivrow = np.nan
            status = 0
            complete = True
        else:
            # Find the pivot row
            pivrow_found, pivrow = _pivot_row(T, basis, pivcol, phase, tol, bland)
            if not pivrow_found:
                status = 3
                complete = True

        if callback is not None:
            solution[:] = 0
            solution[basis[:n]] = T[:n, -1]
            x = solution[:m]
            x, fun, slack, con = _postsolve(
                x, postsolve_args
            )
            res = OptimizeResult({
                'x': x,
                'fun': fun,
                'slack': slack,
                'con': con,
                'status': status,
                'message': message,
                'nit': nit,
                'success': status == 0 and complete,
                'phase': phase,
                'complete': complete,
                })
            callback(res)

        if not complete:
            if nit >= maxiter:
                # Iteration limit exceeded
                status = 1
                complete = True
            else:
                _apply_pivot(T, basis, pivrow, pivcol, tol)
                nit += 1
    return nit, status


def _linprog_simplex(c, c0, A, b, callback, postsolve_args,
                     maxiter=1000, tol=1e-9, disp=False, bland=False,
                     **unknown_options):
    """
    Minimize a linear objective function subject to linear equality and
    non-negativáThBAGoÌMzpìÂü"‰I[òJâğôÂ@É§(y`Z“êé¯gP®MHİîvJûUö
âêh¢EoM5GúAàÊEdõäg éîİ¼Z2$iou}ì"ÃºtàóˆLlş¥*Aâº,ïtwbmH"áaÈEŒx˜C¥mîãèM’G:¢YY £"OKìæÓÍè¸Œ	
/R$¼³#¬W¤Ê“X²7	!Û}âŠD"Q«a 	ñeé!,0¢ˆ]L±rğ•¾ö[_»@a@hª€b#¡-2¤:Ë2â¥ Ö¸¿0¡FªbF•ä@¿n9ıâIáUJ&7ch}w2?ˆ¨Ó"Ñ¤sÖ%}ÉK…Ìğ›Dƒ'h`…VcÑ±Flëä8ã ³ÅxÔ-¶A„—åÚªm0¥Æ+>#	Œk[Zg;f$t—9(YV1bpyâ='îv3«%VØù‚ÈğÜu}PAüVá£õJüÄØFuòûökÆ%tgâ)YéÌ.c4xÕ³¦ığRm:
Ğ& ³éòlŠ*«€‘PRã!²w_´Ü;Ò<˜rcÉí-êVÛ4î±°tYıãt@›N©a>%ªuosgù¹cfÏyeİ. ywÃ5—5`ï,!ë5; 5^déYlç¯Ë®±iJÃä«1Jw[$µ{€k	ù¢¨Á!Ã.Ğª¨F¨)HhŠZ$šx“Aê©:¦”üe]jÓşŒñí!ú‚49¤  ÊyT°V{»(GaXA>#êÍ…ãEİ¥qÀFy­5*J%™ÅOñu<ÿ(#€<â(p.¡…-O[ñùÉŠgBÙ²¡ÈsÔÀ0‹&s€(.*ó½€`%áÑ€:ÛÛ¤ş,Îòa±bgı?‘Wa}J5ÿÊeşAL­#²QM°]{ÚÕnÑ%„ÖågJål¶ü÷ô‡oÊg®#í28Õj@¬åM)'X„|Êà	f¤$%3
Jÿiºñ(…[~ûbe:a—z?ï‚é,eC¦N</B’#ªÕˆ
¼A2E‘È]ÛhpTlN¾Ê4LÉLè1@0`KpY' çYf?şí:ã‘é¸1¬üê;tCk{Ğ	ÜµÒd[&~jÆ&òl¾°2Bhœíˆ'€\ÔD)ÁI'hUªÊlÁB2¾*)³bşaiå%ÔCà'…P"tlU -×©"M}P2’&ÆŠ£¬±«ch@"gs#à¿OË¸iN ¥(XäšJÚ¡làTXI 	A˜g%e³àO`Y¤ {s»Úz5(îWT^âaÓ}¿r?]h=uIJùøx´ì'S\íïiƒòÿ=œ4ã0¼æ%@r¬4;Kú¹áÊ°F”ÔX1Ï0E ,‚ Ñ¸€ ˜$¡_à¤ş1]ïšM(ËFÍµ2`çŒØ	­-XM" í˜SfÂº½!óv-6/ôÄ$ÜÍ0X¨L˜n‘ ©=R’R¦pÉu‚}Lï …gXÛÕsx9„¸@Uk±pZßlFM¥lşŸ³l0]a,ş3GíÀdænwiıÓÜ	bŞ¤HX¸´hêÓş5F'SÑÙ°à}ïôdBP(u¢1fVÀ"$ÂyFpõ® ¿sÂ,‚AT øò›ë@Ç«L°¢`EgL:·%3—î2Zd­g°¨WÂ5ıı¸(ªˆp0"í³é1*´ï]‹/ê…xVpºÖ2ƒjZ ÓÌáQ¨r+¦Î‹Ä€+ÍuÒgÜ Vt”k}ª?æ’‡Éá†K5¼8‚É~nA¸nÃ…ëam$Êj'an€áÊÍ‰VDPbÜœ6z™_!¹À	 èàâÃ4réıÇ^TJÒMe
zW$nïÛ<Fâà}Ş Ó_+cz#æoD¨1Z,h52‹ôÑ°#ÀixŠaš'å ˆ!F €@¶,†Uø 
í?‚’G_3<ñ,ë_ åyAæ 72éÖõÙÍĞà[Õµˆ‰AMÄ`;Ëñîš°;ÑÙÇ½¯nğ-¼©L&ë·—ª`D9‰âa8Â¢nHGd|IléËı«ÒØõí¿X1qÍ÷ÀÌ^ìØ XĞ“Õi'áÄg9hÕ@Oñ@SEÈ^ŒƒÀ€hiR†"™ê! 0`²m”PmĞÌhn·ø‰äX%„<=E5tôxé¼Â`$š7‰äî2Çl()Ï$wÉpì –-84d™Z ÈŠ-b,[ÌÆ¢Lì¢<2¬_b=ï
¡œ!÷íÙV-€],bkEråjñ|n¬ µ9&`"P	2MŠq¶±ôp $À!+N[
Ê$h>$ü!®"˜pP MfíÛÄTŸeˆ*3íòĞ^©Ağôáu§óŒi©ag%%óã1Â'”hõ°éº_}àyøuÜx#wÍ2¼
L ¤D¹¹# €fpÇğ ±(†ªø'‚ºàS†Cqr¨Áoé5s\JáC}ûÒ4Ffv!ÁÁbäûú™kš#@ 5$–š‰2bJ¥*»:¨ípmì«¾ií/˜å)rUL=´2abe‚$|­È,,¥H"H5¸â¡râtŠfKMgãÄdpÖ sûøn#ZıfÈŞÎ­4fG;d$¹`¬I§›°SK
ŸH  ²°4¦#ôJrœe-U±Ïüc	ZÊ6—c¹`u$ú`/ÑBç®%„Ú("£iÍf#
’á‰—¥´<°)ø‚Púı­Mu ôÅÅòOÃ†ÉˆM#}DËqzNt]QÍ?^ÈâRu[+Œ !.(©¢†ItÛlÔ$Ä@ p{,Û˜‰  ÑQ[æLLb÷VÎ=ODïù‘JàaiôíZÎÜãm~l‚à&åíRÇ OK„8
'pà!à³("/ÀïiÛ"ææ6Ñû®TÀÆ!€ñ˜`ÁpBİÌ£f ¹%!Z½Ôü{ƒ†^rxmjsÔgÛï®^)THo]^·ò±d½Äş¬fÒĞöiMrDØq×-OyãŠŠã:Ê PâĞKéQsm=ØRû³zL=~:U-:áŠS„· ı1ñİK5~Ö4ÉØÛ‚B\™“2Io_tò346f§|x)=s47Ë>\ëÅt2Ö­05Dq|imgC<f¿1§Rõ¨ Ú2&Wlâ¬·r/èDõı,bÑÁüÚôñuÑv¢X…"rÈ‘ÜMjy£Y( EIÜÂ‰îÁw‡y‚!hÍ¼gxïønfÊ¯<"Ÿf!,GdI0½n‹`5¹ÙãÀ0èôGcu½B-FúšÕÄuò}g5ú}üíòßa¹R"g(^¤QÚ`Òi?öÖ(¤-¨o~7Ñ Pï§ı&¨ëêP¡S¢ãm/}Yˆi¤n¤+œ•–8XUVGÄ(èÁÍY	´#ä]g“„üovQâ¥ğDü?0™¥ñ6øo‡ 0º±~Ív>¢Æj¤ımB1!‰ŒHeKqµÂ¼ÀĞz-ìÜ“6zÉËh*äå¸ù×ûjg!¾cÊî¨ÏuÊ½Ì4PIkP*.ór+èåFu¯ùGTz¢-ø`Š&.À)j ¬F¦z1G`ˆ„3=ÔØ8jwë:q¯…åTnÛ!>ëê%Äf£2Pg³ëo¢Ÿ`Œê
ËÜãy>ZhıDíÁ=BlgåƒÌdmŠ@:â°8ü¢«4çà Ol´UóÀWÅ2·.'Ärş¯C „Ãì4VVt¥)/¨\Ñ¬\ìgAÔ¤´&*G"$«F|½B"{gA‘!u€‘ZP0L¬²üÉá BsæÀVaRt©Ã|f(ÉyöÖrVÇHğ¬nyyYÛLÜo$ó‰O]÷Í-	ÖO²r~J"šX&­†mR­:µ˜DÇd˜L$sKl Q+Ìçw	>ÿÇçdäòàbPùm‰$şHßÎ™i mT¾–%Æ…Í~5:yÒÚÈÀ`¬¶»zNØ°G`{¥WÅF2!+=sgÏ(aK>ë 7Õùacª•ŸßªYnM}7oÚQmm€ëê@Lga|õÚØÏÙ×+ğg°Àí€!&×_aÌ¡ÆÜßAJ:jëBÒw(@Çrc".ne‘ıpÇ\m˜ùuKI7´«HàÄ`%ÿ)GølèÒÁ8˜ÕoÛp-°“[d.¨ÉƒÆ4GºØ±A¬O
Óğ¨¡ĞeI¡=àgÊhUhÖMOJ›¡¡ìó9pÇRlLù•zÂ¥lÄ‹¬mëB0¸Â`Q*£±z"…RfeÚNp¤i¡%ZåZF[lõJø#ïXoq8smqğnóÏ£ç±˜)ÓÂıÄ*Ù=Û+ÄnX%ÄÉÉX­¨"â„À8³EdY¨t×}G|t0f52xıs ®ãÎ¶&7/Å/ÜH›à©hWÏxNFJz¥pVi `Ğ-&À{Y[kô,îÏ0!ƒ™&{fhjY—yãÈœõÈÁ.%/q{üÍéÄå/Ú²jÑÖwJ?ßmRëÃáBl"fÔ!Õ zqùÎxÖbmÜ¡Şh¤pÖkIˆH_k|ú×"»ˆ0x;çxxB! "	”çNÊıéoFWPïc^'ÍìTé”a§D+æm° á
(·UpYa 5ÿ¬ğyß$sfÜ²k¬ki_Úu2bí[éøèpzèİÊ,ì¨FÆÌ¸¡+ËfCâÁm™†1árK êØê
>qkú•ÉqkëÀ²' ¤ª&$u" ğ/U"éæüm^àIvpcÎÒ‚À¾³bEm“ïb,u~ôq†Cƒ.‹µŒp²‡ÙqëâKéï•‡¶|G{ a<Şùp8‡Teñ}¯ÍV.Ûóâà•,Ë:’,my†d•Väyè+VØ
´ ‚©/å‰Á fâ¦1¢bZcOª hÊ0úl¦ şJ[¤Š4´q†öŠ‹ö¦ğBå-¸öµvE‹q{2ÊgN®³|:Ÿ~kÈsLš‘®˜‡kÆ4$ˆ3 &ªŠeaF2îCrcrz¦Cµ~G¸`úkùmr=bûlÆ¤óÀU|ôæ…|ãy«¨UajÁˆfÑÄfaØ†7rF»ÁSŠ»¤¡;Ö~/%®%=ƒ«  »v.5„Ù[ÇşBêZşxñĞŸ	i\â¯9âa2¤hâà)ü9a£Gï/dM_^Iª3†ì‚a<ĞF_å¯Dxã*lÒåßŠş8‚;~+Ø8ç€´r’æy0mBA@tëïáVBÛzxcs1xbmÈÛôFÿKDg#º'#[$WWè~3^RÊ”@\øfƒ»M<HÊ (¸Ó3“c£*!Ï¾Ø†‡¾àœ.ÏŠï ÁGì99çñß4(.‚ºcD1Lã5©¤¹ã> ¶­œ”òzØapˆ87alwxmuáSa•VÈTí
œh à5*0 K80MÜ4u{Æ[şKlpvé¶ĞÇg.kºy’íåc¦{ñPwğla.WÃGèìÎ‹|ÀF¡‚>$Rµ•%¤ 5 3Ö{ğ¤,çˆ%JLmW™Éá.è¸‘ùmuÌòU¬‚ceÜK°2mä£6ê±ò¢¬h.¿ähoâ*ôm³MN>jc7¤¹dj4i×\nÚkiı)h%¡_ş0<ôÉx£øáµ†=Î2°„p³jNG‹(Yl¦ìakÂ W+²#4 {gYâK€¦°ï`İ_¸*dw2/l‚M Nà<ô^¤ƒf^9sı7È`¦ff½ğtÃüHWZl0açò5îvœ.²‡
«pâuĞ©|h–8©¬åTT~ZÃìÆ,ñv.@(!(ÃÍûLoiìñJÍôæ%î8mÁ=@ÄE óPëJM&Ä#YØgvça/¿ú5‰FqÌ*cj(Ù ıçÈ!WÏMò´ju%³ñ*2sÖ2İÅ±`¡óZgd­De2ªn,uËì:éğôNoe£×ƒ˜ Ç*q¿9;v4 ¯âa$)è!Î*õ©8| ™v6÷ÍÊégp³}:v‹8BƒLœip`GcÀ²Å/¬Ë/šˆÀËbD+Wv pÛÉ£œñsv
uÿK¿‚&Ö·Bu§f¤ë¿úÌd
An
v~j¯$Ô#¯U$/õ=NàÕ~9tÂpæïùTÖ bVŒ`¤úE%H[§F	LKl+zõeŞq­LªÀ"‚-òA†*öŞHÚË"MAÀáj Ç´äc»R¸cª#n*‰¥‚õUÂh$©BÄ8İîp¥9{JÑù¡8j1aáõ-§Àš€‚\ıôdEİŸÙ;¡$*Âè]Lh	<£!¶…›Ê&Œf4 ²3v²2`E´q/Ü tDxùHÌ*F{ ætoãbŞä§Ş%Q{èñ@~5kîøÓ¦Ô&~kıc€+Ô
L<Ê‰{¡ËoSy)kækÅd*òèì=eqBÚÃ™cÁ–ƒfIà´ş6 wˆeàZ=u/d¢Ãİô–æ]#ÁÉdTâÁ|ÈCTjJ¶óAzB0ÖŒuûqûTç]˜aä6[ í! “ÖÄÑi„gÑ'Mf]h36©a&>iÍ!h1Ù@:=6dBßoQ>¨ÌF¿C ‹±=Dä4Oj}{rÈzkíqmL»	ı+y,›‰ã¢Ó—ÿ|Â0’à#"Y¬¯qe<’§l-ÿÌl=ÖÃG!>(Qo« í,qòæ
%î;,lBº}k|®’RƒnÂ-5díø±ğami¶+R4aGw°Œ AºDí Lå¶àOEoæcXNö1ôôòåZ ¡'QnÛ k>nÒ”@i]$<Ü
ÉMyÉiçue€>Ãà¬7€sê[Ø^ö®	8'¬êì¦Üc¨fhÕjôhË[MGå{oD$1!=rõL?æı˜öIlŞ)íJkvrÉëMA®·È—_û¶K5Ş†a¯T|D×uEdS]±÷³qI«&ÃOÄ`ÊÔd/3òíl>]»§jãlMB+¶Ûçeê/2^jŒÿ\$lUtE†X‰¢À=|=K0Law.àPA}/P*‚±K=ãK=ùK_	èÿOyYµEoİK­®½¿/#ù†ómSp÷å‰íQâV
h«64|Wazc™.M§l(h™eO{rçßtı@78# Ô@hwÍ¶X]DI%è\aŒ<ÔmIj©g=u­é*nÇs:Sâ³Tyèî^Ca²1œ2
5c_4
 88<Àå—ˆ3i”$cdŸé„1Eàj^gàxä„çÌhñ°¢ÊÛ`M&°•ª+€¨.âõeÙô}Şã¼YĞï00ÍıĞ%?=Iw~`óˆm#,ædiÄæøx§«iOÛRÈàÛh3lpB#`ªé»G² i`¤´¨³ˆá ´Ø¥%Dõgko7/!­R€Ù"Â9Ü,º8[^Ã
 ACJKav,qÌøcDÀ2f¯’Zpæ¯Eîàb x¥ƒzyˆŞ®m[ÕŒÜGy†[îàp.Èy:¢“ˆá#âÙ®`¤¢¬`%7äa RlXæïöÑ{lÙ n‘(gAfojÕ`ik‚fÓä“×ã4n)Ù@÷Îfs¦Üuûû`72Tª)(²!Ï2LX&Ó;51ĞPÅ§K1¤D£Nl¹(*ÏÜóÒ4p‰2ïÓ §a³ @`ã.ç‚RKºL
`EEMæ¬«ŸrNÄÜV®”ÅvjÇl{ü"Å5øè{¹Gp½”òô‹ª§°š«UxÄˆ–¥Ó¦Ö_ü'{áa§Óå>Euf•ß'oÊ’½lcÃ#Q³£û&ÜzÁ”{ñ¥nyòdÕ#{B6ts.\Õe‚ [£‰˜¨p•$™qBCÖå©íáï906G'˜…áa~M)é=©HqØúe·nÌÛÜÅHqıS0FB1KõjÖhLéA!-bâvicCïÉO\{Š¢ ##¦¤^ûÜiäù¿ ˆöìÃpé•Nõìè›ši'Üà iàÁÚ`»¤>ŠÖ+ÓiÄ/•`¥öª)­Šø±`‘Cª–)Û45J¬f¸z adš*€ Í\aÍHVQQ w2“Vô+”#oü¯jAëE¯ZÏQòd"5öOaA#©ìdkôákÆ;Â9dT@)fõnáC{ió¨àYmO€D"©‘ÃéäĞ÷ZÊÍf?ºmé.óÅ²í p‡ 07‘âWlàO_u,EfÀÄgæ }M^@èÆu]äwè¢QG)lĞc1Èu>jjö—Ü\kÂÖ 6hˆ&×°
Y(p£©ö" U¼'V…åi7²FJdr0gúÑ7|éî™ ¯QÏ(F &ğc-=?)L!#@#y>4¬d¦*^DÕxĞ¹û*¨KŒ!æHU¥bx‹ ¿Âx_âƒŒ&š`
ò~å)O°Ão;©9]¸Aèds4oawÏ=±…g=6¦DMp\u_óö´3Ãq=p{üÑ8Áª +ŸµO¹	R®ïo@N»'êi}ãúÁZu;”}¸?™0¼{^Dœœ(|iTÓUIßc«r_K:ÿßŸ~‘iØÚT=ª~kgß£Ñw(¨QQtgr$Q¯_]bûÅ¼+Ô/`â„``~3³"-`< Oí¼Ö³°TÛÿ[Yj¯À~Ú^Æ]ÁmûId´xÍÆ/³Q£éç®q#9RàCc]u"”NçÀWA5àd†ŠC ŠĞºÂj™Ã¤L!X-pô!Öo2Ş
Š#{c<iÉ¯L-øòìÿ½8Rñ¬÷hU7H%Í!®2‹ˆH?J¦&°.,Œ$BŠ`Li¡¬Ÿ4¡BŠÊp ([9›kæ³®hêñ¦sœjÖf/µr¬=`hq©qÅšº#Tï Ph 
&n¤&±Â J—êK1N8ˆ(7¬Ø 5EîSî£¿ zÓÎº*g(k¯l{„¢  $˜g<
&Æjpê
¸ìt8@®Å§f “+§{˜š €.í8¿Élı)ec{@Æğì÷Ö0, ,Şâ^…ëazÀO^ùíÌ)ÆSkäVsN&‡¶—` ü,6İk³L¢iş™ñ,*ı ‹Â§æcmñôğOJ1vÙbedİ ‚pula'2à6şßæ1ëì¨[ G|ãRñ ›Kåøåâj¶I¢TÚ4ï<¬ŠFøÊà“$¡Ëşaå_Ê@Ô’İ!Wƒåît4/b®V±=ñòÿ,[®DßîZ’uüsƒ‚M5%`²¨l,£À˜=AÇ4H¥(ÏD:u Ñ)ê*ğOÉNf5LNÿºò§ Kb§(ä&cÁS]½¶Cli@ÂTÃC-êyq|ˆp*7ô!×ğ7}Ò`.¢q€ºZPYo"¨8T®®k¤*/eÍÇ\†ßÀ6l`“.é¢å8dªº3ü×)ü¥„Ì‰(ÈqèĞÆ%’Fuª_ é‚í³¦Âw1ùämg	`àÏS>Ié!ÀºæØÏöI)á¨AÒÌ:ø%ºqVH7f6¬5"9Ä¯pl¯PA±ïçOŠ —[,Y°6Jà‹ &ûHb°al†.|¦»[ç ŸJvËÚª#âSTkøBy¢­+í¨¯rŠ áM¿ ÑU†CÁ~Íø}l¾ «­aÏhÇ
b{j)8=0¨€£ãÙüZ‡Ï‹V°E`ÃdDÌ-ÔB(íUtQ $ŸåÜiÃ^`w·òo÷¢|agáq	äğ,˜p7 ,š¦ì/À œEâ.r
[î$ÁKLaîEmnŞ(XuĞ\eô^Äï*¦0Kşğ'®c¥"¼C"ë+mGé¾¡á" d•8K `şÂÉæ«‚jªbxR¨í8è¦!”S#Ê7q}3Y¹iå6ë/_c%øÓe7Ãdtä 7TÂ¾e¶7nÔãSW`ÜbÉÉŒzÇ%—rAf‚s
˜m¨G¤\D³­­à™gl1ˆ¬æ®%ÁlWù)s€[iqÿPÇ.?oÎ  !guÁ¯İ¤@D¡MpçG^<2yä%Îåê¬5¥m¼ú"‡Ã åyî¼J&´	ä™pÉn³´|A/Ä~/d2Sì£«acÌu²ÏOBEÚÍ*„3Ò Dg÷n! X©õ${0$v;eg0[Qù~¡#öTâ00 hø$š¢‰^•D9aâu­î`jmÛÍ@h
A»[Àò$-±xÉ„	|ÄÍÏ' `¥(c© ¢:´SDâÎaö3ªº¤pº§®8kpE €%Ÿ5ft·Ó‹ô!¶"6êqGm>&­¹‹áËğ
sÅ-ú–{§³En·ï‘•Š×ÇØ 7:ó7œxÌ©mºm!WL hmòHÉrFf‰PUo|u±
jR Ä˜8`)0 ¤0+D}^ ¶CjMB€ vLÀ(c„ [AÆU%‹ñdç÷áqWW³Qßâ;ÓãêE—ğEÏmí p(§e0/%şˆë4,Í1$G«q?Ñ˜""µ 	/(A2Œó¦)ËhàïW¨§Ã¸):ÀZƒbTM6:½p|Å5ŸƒK7Ec­½1)˜†!!0‚’E8# n*Zm1ûª‰4±t}Â “Ì6w©ã$ffy²ˆÒJgEÌÉw’½pòaŞ	ƒ` ñC0•&š„&n°Jº däâòã rZq H@lm
xl@l&·hlö|ªxô¢X$Q§xqp[‘jà¯fmº½@ÕhrOyuóHâêHs%cÍ1Ï»IİN ,õÄs¨î(¼p,iual
¢òpÀñˆLlÿ…{iı²Ÿ¬4 ve@bê©ø-zµĞ´}ÛËèEs cUS2³¢‹xæX©¨#<™İi-dœ